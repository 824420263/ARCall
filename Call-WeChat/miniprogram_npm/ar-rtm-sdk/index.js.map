{"version":3,"sources":["ArRTM@latest.js"],"names":[],"mappings":";;;;;;;AAAA","file":"index.js","sourcesContent":["!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports.ArRTM=t():e.ArRTM=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=2)}([function(e,t,n){var r;n.d(t,\"a\",(function(){return r})),function(e){!function(e){e[e.INVALID_OPERATION=1]=\"INVALID_OPERATION\"}(e.BasicErrorCode||(e.BasicErrorCode={})),function(e){e[e.ATTRIBUTE_OPERATION_ERR_FAILURE=2]=\"ATTRIBUTE_OPERATION_ERR_FAILURE\",e[e.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT=3]=\"ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT\",e[e.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW=4]=\"ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW\",e[e.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN=5]=\"ATTRIBUTE_OPERATION_ERR_TOO_OFTEN\",e[e.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND=6]=\"ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND\",e[e.ATTRIBUTE_OPERATION_ERR_TIMEOUT=7]=\"ATTRIBUTE_OPERATION_ERR_TIMEOUT\",e[e.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN=102]=\"ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN\"}(e.AttributeOperationError||(e.AttributeOperationError={})),function(e){e[e.CHANNEL_MESSAGE_ERR_FAILURE=1]=\"CHANNEL_MESSAGE_ERR_FAILURE\",e[e.CHANNEL_MESSAGE_ERR_TIMEOUT=2]=\"CHANNEL_MESSAGE_ERR_TIMEOUT\",e[e.CHANNEL_MESSAGE_ERR_TOO_OFTEN=3]=\"CHANNEL_MESSAGE_ERR_TOO_OFTEN\",e[e.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE=4]=\"CHANNEL_MESSAGE_ERR_INVALID_MESSAGE\",e[e.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL=5]=\"CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL\",e[e.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]=\"CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN\"}(e.ChannelMessageError||(e.ChannelMessageError={})),function(e){e[e.CREATE_CHANNEL_ERR_INVALID_ARGUMENT=1]=\"CREATE_CHANNEL_ERR_INVALID_ARGUMENT\"}(e.CreateChannelError||(e.CreateChannelError={})),function(e){e[e.CREATE_INSTANCE_ERR_INVALID_ARGUMENT=1]=\"CREATE_INSTANCE_ERR_INVALID_ARGUMENT\"}(e.CreateInstanceError||(e.CreateInstanceError={})),function(e){e[e.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE=1]=\"GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE\",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT=2]=\"GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT\",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN=3]=\"GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN\",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT=4]=\"GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT\",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT=5]=\"GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT\",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED=101]=\"GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED\",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN=102]=\"GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN\"}(e.GetChannelMemberCountErrCode||(e.GetChannelMemberCountErrCode={})),function(e){e[e.GET_MEMBERS_ERR_FAILURE=1]=\"GET_MEMBERS_ERR_FAILURE\",e[e.GET_MEMBERS_ERR_REJECTED=2]=\"GET_MEMBERS_ERR_REJECTED\",e[e.GET_MEMBERS_ERR_TIMEOUT=3]=\"GET_MEMBERS_ERR_TIMEOUT\",e[e.GET_MEMBERS_ERR_TOO_OFTEN=4]=\"GET_MEMBERS_ERR_TOO_OFTEN\",e[e.GET_MEMBERS_ERR_NOT_IN_CHANNEL=5]=\"GET_MEMBERS_ERR_NOT_IN_CHANNEL\",e[e.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN=6]=\"GET_MEMBERS_ERR_USER_NOT_LOGGED_IN\"}(e.GetMembersError||(e.GetMembersError={})),function(e){e[e.INVITATION_API_CALL_ERR_INVALID_ARGUMENT=1]=\"INVITATION_API_CALL_ERR_INVALID_ARGUMENT\",e[e.INVITATION_API_CALL_ERR_NOT_STARTED=2]=\"INVITATION_API_CALL_ERR_NOT_STARTED\",e[e.INVITATION_API_CALL_ERR_ALREADY_END=3]=\"INVITATION_API_CALL_ERR_ALREADY_END\",e[e.INVITATION_API_CALL_ERR_ALREADY_ACCEPT=4]=\"INVITATION_API_CALL_ERR_ALREADY_ACCEPT\",e[e.INVITATION_API_CALL_ERR_ALREADY_SENT=5]=\"INVITATION_API_CALL_ERR_ALREADY_SENT\"}(e.InvitationApiCallError||(e.InvitationApiCallError={})),function(e){e[e.JOIN_CHANNEL_ERR_FAILURE=1]=\"JOIN_CHANNEL_ERR_FAILURE\",e[e.JOIN_CHANNEL_ERR_REJECTED=2]=\"JOIN_CHANNEL_ERR_REJECTED\",e[e.JOIN_CHANNEL_ERR_INVALID_ARGUMENT=3]=\"JOIN_CHANNEL_ERR_INVALID_ARGUMENT\",e[e.JOIN_CHANNEL_TIMEOUT=4]=\"JOIN_CHANNEL_TIMEOUT\",e[e.JOIN_CHANNEL_ERR_EXCEED_LIMIT=5]=\"JOIN_CHANNEL_ERR_EXCEED_LIMIT\",e[e.JOIN_CHANNEL_ERR_ALREADY_JOINED=6]=\"JOIN_CHANNEL_ERR_ALREADY_JOINED\",e[e.JOIN_CHANNEL_ERR_TOO_OFTEN=7]=\"JOIN_CHANNEL_ERR_TOO_OFTEN\",e[e.JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN=8]=\"JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN\",e[e.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]=\"JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN\",e[e.JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE=210]=\"JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE\",e[e.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID=211]=\"JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID\"}(e.JoinChannelError||(e.JoinChannelError={})),function(e){e[e.LEAVE_CHANNEL_ERR_FAILURE=1]=\"LEAVE_CHANNEL_ERR_FAILURE\",e[e.LEAVE_CHANNEL_ERR_REJECTED=2]=\"LEAVE_CHANNEL_ERR_REJECTED\",e[e.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL=3]=\"LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL\",e[e.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]=\"LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN\"}(e.LeaveChannelError||(e.LeaveChannelError={})),function(e){e[e.LOGIN_ERR_UNKNOWN=1]=\"LOGIN_ERR_UNKNOWN\",e[e.LOGIN_ERR_INVALID_ARGUMENT=2]=\"LOGIN_ERR_INVALID_ARGUMENT\",e[e.LOGIN_ERR_INVALID_APP_ID=3]=\"LOGIN_ERR_INVALID_APP_ID\",e[e.LOGIN_ERR_INVALID_TOKEN=4]=\"LOGIN_ERR_INVALID_TOKEN\",e[e.LOGIN_ERR_TOKEN_EXPIRED=5]=\"LOGIN_ERR_TOKEN_EXPIRED\",e[e.LOGIN_ERR_NOT_AUTHORIZED=6]=\"LOGIN_ERR_NOT_AUTHORIZED\",e[e.LOGIN_ERR_ALREADY_LOGIN=7]=\"LOGIN_ERR_ALREADY_LOGIN\",e[e.LOGIN_ERR_TIMEOUT=8]=\"LOGIN_ERR_TIMEOUT\",e[e.LOGIN_ERR_TOO_OFTEN=9]=\"LOGIN_ERR_TOO_OFTEN\",e[e.LOGIN_ERR_ABORTED_BY_LOGOUT=10]=\"LOGIN_ERR_ABORTED_BY_LOGOUT\",e[e.LOGIN_ERR_GATEWAY_CONNECT_FAILED=11]=\"LOGIN_ERR_GATEWAY_CONNECT_FAILED\"}(e.LoginError||(e.LoginError={})),function(e){e[e.LOGOUT_ERR_USER_NOT_LOGGED_IN=102]=\"LOGOUT_ERR_USER_NOT_LOGGED_IN\"}(e.LogoutError||(e.LogoutError={})),function(e){e[e.PEER_MESSAGE_ERR_FAILURE=1]=\"PEER_MESSAGE_ERR_FAILURE\",e[e.PEER_MESSAGE_ERR_TIMEOUT=2]=\"PEER_MESSAGE_ERR_TIMEOUT\",e[e.PEER_MESSAGE_ERR_TOO_OFTEN=5]=\"PEER_MESSAGE_ERR_TOO_OFTEN\",e[e.PEER_MESSAGE_ERR_INVALID_USERID=6]=\"PEER_MESSAGE_ERR_INVALID_USERID\",e[e.PEER_MESSAGE_ERR_INVALID_MESSAGE=7]=\"PEER_MESSAGE_ERR_INVALID_MESSAGE\",e[e.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]=\"PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN\"}(e.PeerMessageError||(e.PeerMessageError={})),function(e){e[e.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE=1]=\"PEER_SUBSCRIPTION_STATUS_ERR_FAILURE\",e[e.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT=2]=\"PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT\",e[e.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED=3]=\"PEER_SUBSCRIPTION_STATUS_ERR_REJECTED\",e[e.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT=4]=\"PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT\",e[e.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN=5]=\"PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN\",e[e.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW=6]=\"PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW\",e[e.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN=102]=\"PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN\"}(e.PeerSubscriptionStatusError||(e.PeerSubscriptionStatusError={})),function(e){e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE=1]=\"QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE\",e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT=2]=\"QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT\",e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN=3]=\"QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN\",e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN=102]=\"QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN\"}(e.QueryPeersBySubscriptionOptionError||(e.QueryPeersBySubscriptionOptionError={})),function(e){e[e.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT=0]=\"QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT\",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED=1]=\"QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED\",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT=2]=\"QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT\",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN=3]=\"QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN\",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN=102]=\"QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN\"}(e.QueryPeersOnlineStatusError||(e.QueryPeersOnlineStatusError={})),function(e){e[e.RENEW_TOKEN_ERR_FAILURE=1]=\"RENEW_TOKEN_ERR_FAILURE\",e[e.RENEW_TOKEN_ERR_INVALID_ARGUMENT=2]=\"RENEW_TOKEN_ERR_INVALID_ARGUMENT\",e[e.RENEW_TOKEN_ERR_REJECTED=3]=\"RENEW_TOKEN_ERR_REJECTED\",e[e.RENEW_TOKEN_ERR_TOO_OFTEN=4]=\"RENEW_TOKEN_ERR_TOO_OFTEN\",e[e.RENEW_TOKEN_ERR_TOKEN_EXPIRED=5]=\"RENEW_TOKEN_ERR_TOKEN_EXPIRED\",e[e.RENEW_TOKEN_ERR_INVALID_TOKEN=6]=\"RENEW_TOKEN_ERR_INVALID_TOKEN\",e[e.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN=102]=\"RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN\",e[e.RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT=201]=\"RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT\"}(e.RenewTokenError||(e.RenewTokenError={}))}(r||(r={}))},function(e,t,n){var r;n.d(t,\"a\",(function(){return r})),function(e){!function(e){e.BANNED_BY_SERVER=\"BANNED_BY_SERVER\",e.INTERRUPTED=\"INTERRUPTED\",e.LOGIN=\"LOGIN\",e.LOGIN_FAILURE=\"LOGIN_FAILURE\",e.LOGIN_SUCCESS=\"LOGIN_SUCCESS\",e.LOGIN_TIMEOUT=\"LOGIN_TIMEOUT\",e.LOGOUT=\"LOGOUT\",e.REMOTE_LOGIN=\"REMOTE_LOGIN\"}(e.ConnectionChangeReason||(e.ConnectionChangeReason={})),function(e){e.ABORTED=\"ABORTED\",e.CONNECTED=\"CONNECTED\",e.CONNECTING=\"CONNECTING\",e.DISCONNECTED=\"DISCONNECTED\",e.RECONNECTING=\"RECONNECTING\"}(e.ConnectionState||(e.ConnectionState={})),function(e){e.INVITATION_EXPIRE=\"INVITATION_EXPIRE\",e.NOT_LOGGEDIN=\"NOT_LOGGEDIN\",e.PEER_NO_RESPONSE=\"PEER_NO_RESPONSE\",e.PEER_OFFLINE=\"PEER_OFFLINE\"}(e.LocalInvitationFailureReason||(e.LocalInvitationFailureReason={})),function(e){e.ACCEPTED_BY_REMOTE=\"ACCEPTED_BY_REMOTE\",e.CANCELED=\"CANCELED\",e.FAILURE=\"FAILURE\",e.IDLE=\"IDLE\",e.RECEIVED_BY_REMOTE=\"RECEIVED_BY_REMOTE\",e.REFUSED_BY_REMOTE=\"REFUSED_BY_REMOTE\",e.SENT_TO_REMOTE=\"SENT_TO_REMOTE\"}(e.LocalInvitationState||(e.LocalInvitationState={})),function(e){e.RAW=\"RAW\",e.TEXT=\"TEXT\"}(e.MessageType||(e.MessageType={})),function(e){e.OFFLINE=\"OFFLINE\",e.ONLINE=\"ONLINE\",e.UNREACHABLE=\"UNREACHABLE\"}(e.PeerOnlineState||(e.PeerOnlineState={})),function(e){e.ONLINE_STATUS=\"ONLINE_STATUS\"}(e.PeerSubscriptionOption||(e.PeerSubscriptionOption={})),function(e){e.ACCEPT_FAILURE=\"ACCEPT_FAILURE\",e.INVITATION_EXPIRE=\"INVITATION_EXPIRE\",e.PEER_OFFLINE=\"PEER_OFFLINE\"}(e.RemoteInvitationFailureReason||(e.RemoteInvitationFailureReason={})),function(e){e.ACCEPTED=\"ACCEPTED\",e.ACCEPT_SENT_TO_LOCAL=\"ACCEPT_SENT_TO_LOCAL\",e.CANCELED=\"CANCELED\",e.FAILURE=\"FAILURE\",e.INVITATION_RECEIVED=\"INVITATION_RECEIVED\",e.REFUSED=\"REFUSED\"}(e.RemoteInvitationState||(e.RemoteInvitationState={}))}(r||(r={}))},function(e,t,n){n.r(t);var r=n(3);n.d(t,\"ArRTM\",(function(){return r.a}));var o=n(0);n.d(t,\"RtmErrorCode\",(function(){return o.a}));var i=n(4);for(var a in i)[\"ArRTM\",\"RtmErrorCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);var s=n(1);n.d(t,\"RtmStatusCode\",(function(){return s.a}));var E=n(5);for(var a in E)[\"ArRTM\",\"RtmErrorCode\",\"RtmStatusCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return E[e]}))}(a);var _=n(6);for(var a in _)[\"ArRTM\",\"RtmErrorCode\",\"RtmStatusCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return _[e]}))}(a);var c=n(7);for(var a in c)[\"ArRTM\",\"RtmErrorCode\",\"RtmStatusCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return c[e]}))}(a);var u=n(8);for(var a in u)[\"ArRTM\",\"RtmErrorCode\",\"RtmStatusCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return u[e]}))}(a);var l=n(9);for(var a in l)[\"ArRTM\",\"RtmErrorCode\",\"RtmStatusCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return l[e]}))}(a);var R=n(10);for(var a in R)[\"ArRTM\",\"RtmErrorCode\",\"RtmStatusCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return R[e]}))}(a);var N=n(11);for(var a in N)[\"ArRTM\",\"RtmErrorCode\",\"RtmStatusCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return N[e]}))}(a);var d=n(12);for(var a in d)[\"ArRTM\",\"RtmErrorCode\",\"RtmStatusCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return d[e]}))}(a);var f=n(13);for(var a in f)[\"ArRTM\",\"RtmErrorCode\",\"RtmStatusCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return f[e]}))}(a);var I=n(14);for(var a in I)[\"ArRTM\",\"RtmErrorCode\",\"RtmStatusCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return I[e]}))}(a);var O=n(15);for(var a in O)[\"ArRTM\",\"RtmErrorCode\",\"RtmStatusCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return O[e]}))}(a);var T=n(16);for(var a in T)[\"ArRTM\",\"RtmErrorCode\",\"RtmStatusCode\",\"default\"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return T[e]}))}(a);t.default=r.a},function(e,t,n){n.d(t,\"a\",(function(){return d}));var r,o={VERSION:n(17).version,GATEWAY_ADDRESS:\"https://rtmgw.agrtc.cn\",GATEWAY_CONNECT_TIMEOUT:6e3,GATEWAY_RETRY_TIMEOUT:12e5},i=function(){function e(e){if(this._url=\"\",this._wss=!0,this._port=443,this._timeout=6e4,\"[object Object]\"===Object.prototype.toString.call(e)){var t=e.url,n=e.wss,r=e.port,o=e.timeout;\"string\"==typeof t&&(this._url=t),\"boolean\"==typeof n&&(this._wss=n,this._port=n?443:80),\"number\"==typeof r&&(this._port=r),\"number\"==typeof o&&(this._timeout=o)}}return e.prototype.setRequestUrl=function(e){if(\"[object Object]\"===Object.prototype.toString.call(e)){var t=e.url,n=e.wss,r=e.port;\"string\"==typeof t&&(this._url=t),\"boolean\"==typeof n&&(this._wss=n,this._port=n?443:80),\"number\"==typeof r&&(this._port=r)}},e.prototype.request=function(e,t,n){return this._sendUrlRequest(e,t,n)},e.prototype.post=function(e,t){return this.request(e,\"POST\",t)},e.prototype.get=function(e,t){return this.request(e,\"GET\",t)},e.prototype._sendUrlRequest=function(e,t,n,r){var o=this;return void 0===r&&(r=!0),new Promise((function(i,a){if(\"\"!==o._url){var s=o._url;e&&(s=o._url+e);try{wx.getSystemInfo(),wx.request({url:s,timeout:o._timeout,method:t,header:{\"content-type\":\"application/json\"},data:n,complete:function(e){var t=e.statusCode;i(200===t?e.data:{code:-1,msg:e.errMsg})}})}catch(e){var E=new XMLHttpRequest,_=function(){200===E.status?i(JSON.parse(E.responseText)):a(\"NETWORK_RESPONSE_ERROR\")};r&&(E.onreadystatechange=function(){4===E.readyState&&_()}),E.open(t,s,r),E.onerror=function(e){a(\"NETWORK_ERROR\")},E.ontimeout=function(){a(\"NETWORK_TIMEOUT\")},E.send(JSON.stringify(n)),r||_()}}else a(\"NO_REQUEST_URL\")}))},e}(),a={generateLowCaseString:function(e){var t=e;void 0===t&&(t=7);var n=Math.random().toString(16).substr(2,t).toLowerCase();return n.length===t?n:n+this.generateLowCaseString(t-n.length)},generateUpperCaseString:function(e){return this.generateLowCaseString(e||32).toUpperCase()},getByteLength:function(e){for(var t=0,n=0;n<e.length;n++)e.charCodeAt(n)>255?t+=2:t++;return t}},s=function(e,t){var n=\"YYYY-MM-DD hh:mm:ss\";if(\"number\"!=typeof e)throw new Error(\"[timesToDate]: timestamp must be number\");t&&\"string\"==typeof t&&(n=t);var r=e||Date.now(),o=new Date(r)||new Date(r),i=o.getFullYear(),a=o.getMonth()+1,s=o.getDate(),E=o.getHours(),_=o.getMinutes(),c=o.getSeconds();return n.indexOf(\"YYYY\")>-1&&(n=n.replace(\"YYYY\",(function(){return\"\"+i}))),n.indexOf(\"MM\")>-1?n=n.replace(\"MM\",(function(){return a<10?\"0\"+a:\"\"+a})):n.indexOf(\"M\")>-1&&(n=n.replace(\"M\",(function(){return\"\"+a}))),n.indexOf(\"DD\")>-1?n=n.replace(\"DD\",(function(){return s<10?\"0\"+s:\"\"+s})):n.indexOf(\"D\")>-1&&(n=n.replace(\"D\",(function(){return\"\"+s}))),n.indexOf(\"hh\")>-1?n=n.replace(\"hh\",(function(){return E<10?\"0\"+E:\"\"+E})):n.indexOf(\"h\")>-1&&(n=n.replace(\"h\",(function(){return\"\"+E}))),n.indexOf(\"mm\")>-1?n=n.replace(\"mm\",(function(){return _<10?\"0\"+_:\"\"+_})):n.indexOf(\"m\")>-1&&(n=n.replace(\"m\",(function(){return\"\"+_}))),n.indexOf(\"ss\")>-1?n=n.replace(\"ss\",(function(){return c<10?\"0\"+c:\"\"+c})):n.indexOf(\"s\")>-1&&(n=n.replace(\"s\",(function(){return\"\"+c}))),n};!function(e){e[e.DEBUG=0]=\"DEBUG\",e[e.INFO=1]=\"INFO\",e[e.WARNING=2]=\"WARNING\",e[e.ERROR=3]=\"ERROR\",e[e.NONE=4]=\"NONE\"}(r||(r={}));var E=new(function(){function e(){this.logPrefix=\"SupLogger\",this.logLevel=r.NONE,this.uploadServeTranslators=[],this.DEBUG=r.DEBUG,this.INFO=r.INFO,this.WARNING=r.WARNING,this.ERROR=r.ERROR,this.NONE=r.NONE}return e.prototype.use=function(e){\"function\"==typeof e&&this.uploadServeTranslators.push((function(t,n){e(t,n)}))},e.prototype.setLogLevel=function(e,t){t&&(this.logPrefix=t),\"number\"==typeof e&&e>-1&&e<5&&(this.logLevel=e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!(this.logLevel>r.ERROR&&this.logLevel!==r.NONE||this.logLevel===r.NONE)){var n=e,o=Date.now();n.unshift(\"[\"+s(o,\"hh:mm:ss:ms\")+\"] %c\"+this.logPrefix+\" [ERROR]:%c\",\"color: #b00020; font-weight: bold;\",\"color: #dc3545;\"),this.uploadServeTranslators.length>0?this.uploadServeTranslators.map((function(e){e({type:\"error\",params:n,timestamp:o},(function(){console.error.apply(console,n)}))})):console.error.apply(console,n)}},e.prototype.warning=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!(this.logLevel>r.WARNING&&this.logLevel!==r.NONE||this.logLevel===r.NONE)){var n=e,o=Date.now();n.unshift(\"[\"+s(o,\"hh:mm:ss:ms\")+\"] %c\"+this.logPrefix+\" [WARNING]:\",\"color: #ffc107; font-weight: bold;\"),this.uploadServeTranslators.length>0?this.uploadServeTranslators.map((function(e){e({type:\"warning\",params:n,timestamp:o},(function(){console.warn.apply(console,n)}))})):console.warn.apply(console,n)}},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!(this.logLevel>r.INFO&&this.logLevel!==r.NONE||this.logLevel===r.NONE)){var n=e,o=Date.now();n.unshift(\"[\"+s(o,\"hh:mm:ss:ms\")+\"] %c\"+this.logPrefix+\" [INFO]:\",\"color:  #007bff; font-weight: bold;\"),this.uploadServeTranslators.length>0?this.uploadServeTranslators.map((function(e){e({type:\"info\",params:n,timestamp:o},(function(){console.log.apply(console,n)}))})):console.log.apply(console,n)}},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!(this.logLevel>r.DEBUG&&this.logLevel!==r.NONE||this.logLevel===r.NONE)){var n=e,o=Date.now();n.unshift(\"[\"+s(o,\"hh:mm:ss.ms\")+\"] %c\"+this.logPrefix+\" [DEBUG]:\",\"color:#6facff;\"),this.uploadServeTranslators.length>0?this.uploadServeTranslators.map((function(e){e({type:\"debug\",params:n,timestamp:o},(function(){console.log.apply(console,n)}))})):console.log.apply(console,n)}},e}());E.setLogLevel(E.DEBUG,\"anyRTM-SDK\");var _,c=E,u=function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{E(r.next(e))}catch(e){i(e)}}function s(e){try{E(r.throw(e))}catch(e){i(e)}}function E(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}E((r=r.apply(e,t||[])).next())}))},R=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};!function(e){e.INVALID_PARAMS=\"INVALID_PARAMS\",e.DEVELOPER_INVALID=\"DEVELOPER_INVALID\",e.UID_BANNED=\"UID_BANNED\",e.IP_BANNED=\"IP_BANNED\",e.CHANNEL_BANNED=\"CHANNEL_BANNED\",e.APPID_INVALID=\"APPID_INVALID\",e.SERVER_NOT_OPEN=\"SERVER_NOT_OPEN\",e.TOKEN_EXPIRED=\"TOKEN_EXPIRED\",e.TOKEN_INVALID=\"TOKEN_INVALID\",e.UNKNOWN=\"UNKNOWN\",e.TIMEOUT=\"TIMEOUT\"}(_||(_={}));var N,d,f,I=function(){function e(){this._urls=[],this._urlSuffix=\"/arapi/v1?action=\",this._appid=\"\",this._sessionId=\"\",this.msgSuffix=\"/arapi/v1/artmgw/\",this._urls=[o.GATEWAY_ADDRESS],this._urlSuffix=\"/arapi/v1?action=\"}return e.prototype.joinGateway=function(e){var t=this;void 0===e&&(e={});var n=this;return new Promise((function(r,a){var s=n._urlSuffix.concat(\"wrtm_gateway\"),E=function(){return l(t,void 0,void 0,(function(){var t,l,N,d,f,I;return R(this,(function(R){switch(R.label){case 0:return R.trys.push([0,2,,3]),[4,Promise.race(this._urls.map((function(t){return new i({url:t,timeout:o.GATEWAY_CONNECT_TIMEOUT}).post(s,u({},e))})))];case 1:return(t=R.sent())&&(l=t.code,t.msg,0===l?(N=t.sessionid,d=e.appid,n._sessionId=N,n._appid=d,r(t)):-1===l||1===l?setTimeout((function(){E()}),o.GATEWAY_CONNECT_TIMEOUT):a(-4===l||-7===l?_.INVALID_PARAMS:13===l?_.DEVELOPER_INVALID:14===l?_.UID_BANNED:15===l?_.IP_BANNED:16===l?_.CHANNEL_BANNED:101===l?_.APPID_INVALID:102===l?_.SERVER_NOT_OPEN:109===l?_.TOKEN_EXPIRED:110===l?_.TOKEN_INVALID:\"Error Code \"+l+\".\")),[3,3];case 2:return f=R.sent(),\"NETWORK_ERROR\"===(I=f)||\"NETWORK_TIMEOUT\"===I||\"NETWORK_RESPONSE_ERROR\"===I?(c.warning(\"reconnect gateway server, reason: \"+I),setTimeout((function(){E()}),o.GATEWAY_CONNECT_TIMEOUT),[2]):(c.debug(\"XMLHttpRequest abort error \",I),a(_.UNKNOWN),[3,3]);case 3:return[2]}}))}))};E()}))},e.prototype.getChanHistoryMsg=function(e){return l(this,void 0,void 0,(function(){var t,n=this;return R(this,(function(r){return t=this,[2,new Promise((function(r,a){return l(n,void 0,void 0,(function(){var n,a;return R(this,(function(s){switch(s.label){case 0:return n=t.msgSuffix.concat(\"getChanHistoryMsg\"),[4,new i({url:o.GATEWAY_ADDRESS,timeout:o.GATEWAY_CONNECT_TIMEOUT}).post(n,u(u({},e),{sessId:t._sessionId,appId:t._appid})).then((function(e){return e}))];case 1:return a=s.sent(),r(a),[2]}}))}))}))]}))}))},e.prototype.getOfflineMsg=function(e){return l(this,void 0,void 0,(function(){var t,n=this;return R(this,(function(r){return t=this,[2,new Promise((function(r,a){return l(n,void 0,void 0,(function(){var n,a;return R(this,(function(s){switch(s.label){case 0:return n=t.msgSuffix.concat(\"getOfflineMsg\"),[4,new i({url:o.GATEWAY_ADDRESS,timeout:o.GATEWAY_CONNECT_TIMEOUT}).post(n,u(u({},e),{sessId:t._sessionId,appId:t._appid})).then((function(e){return e}))];case 1:return a=s.sent(),r(a),[2]}}))}))}))]}))}))},e.prototype.getP2PHistoryMsg=function(e){var t=this,n=this;return new Promise((function(r,a){return l(t,void 0,void 0,(function(){var t,a;return R(this,(function(s){switch(s.label){case 0:return t=n.msgSuffix.concat(\"getP2PHistoryMsg\"),[4,new i({url:o.GATEWAY_ADDRESS,timeout:o.GATEWAY_CONNECT_TIMEOUT}).post(t,u(u({},e),{sessId:n._sessionId,appId:n._appid})).then((function(e){return e}))];case 1:return a=s.sent(),r(a),[2]}}))}))}))},e}(),O=function(e){var t=\"function\"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&\"number\"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")},T=Array.prototype,h=function(){function e(){this._events={},this.addListener=this.on}return e.prototype.getListeners=function(e){return this._events[e]?T.map.call(this._events[e],(function(e){return e.listener})):[]},e.prototype.on=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!1})},e.prototype.once=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!0})},e.prototype.off=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e],r=this._indexOfListener(n,t);-1!==r&&T.splice.call(n,r,1)},e.prototype.removeAllListeners=function(e){e?delete this._events[e]:this._events={}},e.prototype.emit=function(e){for(var t,n,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];this._events[e]||(this._events[e]=[]);var i=this._events[e];try{for(var a=O(i),s=a.next();!s.done;s=a.next()){var E=s.value;E.once&&this.off(e,E.listener),E.listener.apply(this,r||[])}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}},e.prototype._indexOfListener=function(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1},e}(),p=(N=function(e,t){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}N(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),v=function(e){function t(t){var n=e.call(this)||this;if(n._websocket=null,n._url=\"\",n._wss=!0,n._port=443,n._listenCallback=[],n.onclose=function(){},n.onerror=function(){},n.onmessage=function(){},t&&\"[object Object]\"===Object.prototype.toString.call(t)){var r=t.url,o=t.wss,i=t.port;r&&(n._url=r),\"boolean\"==typeof o&&(n._wss=o),i&&(n._port=i)}return n}return p(t,e),Object.defineProperty(t.prototype,\"connectState\",{get:function(){return this._websocket?this._websocket.readyState:WebSocket.CLOSED},enumerable:!1,configurable:!0}),t.prototype.open=function(e){var t=this;return new Promise((function(n,r){if(t._websocket&&c.error(\"ERROR: SignalingChannel has already opened.\"),e&&\"[object Object]\"===Object.prototype.toString.call(e)){var o=e.url,i=e.wss,a=e.port;o&&(t._url=o),\"boolean\"==typeof i&&(t._wss=i),a&&(t._port=a)}var s=(t._wss?\"wss\":\"ws\")+\"://\"+t._url+\":\"+t._port;c.debug(\"SignalingChannel start connect, url \"+s+\".\");var E=function(){c.debug(\"Signaling channel opened.\"),t._websocket.onerror=function(e){c.debug(\"Signaling channel error.\"),t.onerror(e)},t._websocket.onclose=function(e){c.debug(\"Channel closed with code: \"+e.code+\" reason: \"+e.reason),t._websocket=null,t.onclose(e)},n()},_=function(e){t._listenCallback.forEach((function(t){t(e)})),t.onmessage(e)},u=function(e){r(Error(\"WebSocket error.\"))};try{wx.getSystemInfo(),t._websocket=wx.connectSocket({url:s,complete:function(){}}),t._websocket.onOpen(E),t._websocket.onMessage(_),t._websocket.onError(u)}catch(e){t._websocket=new WebSocket(s),t._websocket.onopen=E,t._websocket.onmessage=_,t._websocket.onerror=u}}))},t.prototype.close=function(){this._websocket&&(this._websocket.close(),this._websocket=null)},t.prototype.send=function(e){if(\"object\"!=typeof e)return c.error(\"signal channel msg must be object.\"),!1;if(this._websocket)try{return wx.getSystemInfo(),this._websocket.send({data:JSON.stringify(e)})}catch(t){1===this._websocket.readyState&&this._websocket.send(JSON.stringify(e))}},t.prototype.addMessageEventListener=function(e,t){this._websocket&&this._listenCallback.push(e)},t.prototype.removeMessageEventListener=function(e,t){if(this._websocket)for(var n=this._listenCallback.length-1;n>-1;n--)this._listenCallback[n]===e&&this._listenCallback.splice(n,1)},t.prototype.clear=function(){this.close(),this.onerror=function(){},this.onclose=function(){},this.onmessage=function(){},this.addMessageEventListener=function(){},this.removeMessageEventListener=function(){}},t}(h),A=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(e,t){var n=\"function\"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},C=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e},L=function(e){function t(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=e.apply(this,C(n))||this;o.name=\"RTMException\",o.code=t;var i=\"Error Code \"+t+\" - \";return o.message=n[0]?i.concat(n[0]):i,o.data=n[1]?n[1]:{},o}return A(t,e),t}(Error),y=function(e){function t(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=e.apply(this,C([t],n))||this;return o.name=\"RtmInvalidArgumentError\",o}return A(t,e),t}(L),m=(function(e){function t(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=e.apply(this,C([t],n))||this;return o.name=\"RtmUnauthenticatedError\",o}A(t,e)}(L),n(2)),g=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),b=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{E(r.next(e))}catch(e){i(e)}}function s(e){try{E(r.throw(e))}catch(e){i(e)}}function E(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}E((r=r.apply(e,t||[])).next())}))},U=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},M=function(e){function t(t){var n=e.call(this)||this;n._cmdEncrypt=!1,n._appId=\"\",n._serverIsWss=!0,n._serverUrl=\"\",n._serverPort=0,n._userId=null,n._connectTimeout=0,n._keepAliveTimeout=0,n._keepALiveInterval=0,n._keepALiveIntervalTime=1e4,n._revState=\"DISCONNECTED\",n._curState=\"DISCONNECTED\",n.handleMediaServerEvents=function(){};var r=n;return t&&t.appId&&(r._appId=t.appId),n}return g(t,e),t.prototype.init=function(e){var t=e.appId,n=e.isWss,r=e.url,o=e.port;this._appId=t,\"boolean\"==typeof n&&(this._serverIsWss=n),r&&(this._serverUrl=r),o&&(this._serverPort=o)},t.prototype.setAppInfo=function(e){var t=e.appId;this._appId=t},t.prototype.configServer=function(e,t,n){this._serverIsWss=e,this._serverUrl=t,this._serverPort=n},t.prototype.connectServer=function(){var e=this,t=this;return new Promise((function(n,r){return b(e,void 0,void 0,(function(){var e,o;return U(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t._emitConnectionState(\"CONNECTING\"),t._setConnectTimeout(),[4,t.open({url:t._serverUrl,wss:t._serverIsWss,port:t._serverPort})];case 1:return i.sent(),e=(t._serverIsWss?\"wss\":\"ws\")+\"://\"+t._serverUrl+\":\"+t._serverPort,c.debug(\"[ws-client] websocket opened: \"+e),t._clearConnectTimeout(),t._emitConnectionState(\"CONNECTED\"),n(),t.onmessage=function(e){var n=e.data,r=JSON.parse(n),o=r.Cmd,i=(r.Encrypt,r.Content),a=JSON.parse(i);switch(o){case\"KeepAlive\":t._clearKeepALiveTimeout();break;case\"Login\":t._startKeepAlive();break;default:t.handleMediaServerEvents&&t.handleMediaServerEvents(o,a)}},t.onerror=function(e){c.error(\"WebSocket with some error \",e)},t.onclose=function(e){var n=e.code,r=e.reason;switch(c.info(\"serve disconnected...\",n),t._clearConnectTimeout(),t._stopKeepAlive(),t._clearKeepALiveTimeout(),n){case 1e3:case 1005:t._emitConnectionState(\"DISCONNECTED\",\"LEAVE\");break;case 3001:t._emitConnectionState(\"RECONNECTING\",\"NETWORK_ERROR\");break;default:c.debug(\"media ws serve disconnected with code \"+n+\", reason \"+r),\"RECONNECTING\"!==t._curState&&t._emitConnectionState(\"RECONNECTING\",\"SERVER_ERROR\")}t.clear()},[3,3];case 2:return o=i.sent(),t._clearConnectTimeout(),r(o),[3,3];case 3:return[2]}}))}))}))},t.prototype.doKeepAlive=function(){var e=this,t={Cmd:\"KeepAlive\"};t.Encrypt=this._cmdEncrypt,t.Content=JSON.stringify({time:Date.now().toString()}),this.send(t),!e._keepAliveTimeout&&(e._keepAliveTimeout=setTimeout((function(){e._stopKeepAlive(),e._clearKeepALiveTimeout(),e.clear(),e._emitConnectionState(\"RECONNECTING\",\"KEEP_A_LIVE_TIME_OUT\")}),2*e._keepALiveIntervalTime))},t.prototype.doOnline=function(e){var t=this;return new Promise((function(n,r){var o=function(e){var i=e.data,a=JSON.parse(i),s=a.Cmd,E=(a.Encrypt,a.Content),_=JSON.parse(E);if(\"Login\"===s){t.removeMessageEventListener(o);var u=_.Code;if(0===u){var l=_.UserId;t._userId=l,n(l)}else c.error(\"user online failure, code => \",u),r(new L(m.RtmErrorCode.LoginError.LOGIN_ERR_UNKNOWN,\"Error Code \"+u))}};t.addMessageEventListener(o);var i={Cmd:\"Login\"};i.AppId=t._appId,i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({},e)),t.send(i)}))},t.prototype.doOffline=function(){var e=this;return new Promise((function(t,n){var r=function(o){var i=o.data,a=JSON.parse(i),s=a.Cmd,E=(a.Encrypt,a.Content),_=JSON.parse(E);if(\"Logout\"===s){e.removeMessageEventListener(r);var c=_.Code;0===c?t(c):n(c)}};e.addMessageEventListener(r);var o={Cmd:\"Logout\"};o.Encrypt=e._cmdEncrypt,o.Content=\"\",e.send(o)}))},t.prototype.doQueryOnlineStatus=function(e){var t=this;return new Promise((function(n,r){var o=function(e){var r=e.data,i=JSON.parse(r),a=i.Cmd,s=(i.Encrypt,i.Content),E=JSON.parse(s);if(\"QueryOnlineStatus\"===a){t.removeMessageEventListener(o);var _=E.Status;n(_)}};t.addMessageEventListener(o);var i={Cmd:\"QueryOnlineStatus\"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify({MsgId:Date.now(),UserIds:JSON.stringify(e)}),t.send(i)}))},t.prototype.doQueryOnlineSubStatus=function(){var e=this;return new Promise((function(t,n){var r=function(n){var o=n.data,i=JSON.parse(o),a=i.Cmd,s=(i.Encrypt,i.Content),E=JSON.parse(s);if(\"QueryOnlineSubStatus\"===a){e.removeMessageEventListener(r);var _=E.Status;t(_)}};e.addMessageEventListener(r);var o={Cmd:\"QueryOnlineSubStatus\"};o.Encrypt=e._cmdEncrypt,o.Content=JSON.stringify({MsgId:Date.now()}),e.send(o)}))},t.prototype.doSubscribeOnlineStatus=function(e){var t={Cmd:\"SubscribeOnlineStatus\"};t.Encrypt=this._cmdEncrypt,t.Content=JSON.stringify({MsgId:Date.now(),UserIds:JSON.stringify(e)}),this.send(t)},t.prototype.doUnSubscribeOnlineStatus=function(e){var t={Cmd:\"UnSubscribeOnlineStatus\"};t.Encrypt=this._cmdEncrypt,t.Content=JSON.stringify({MsgId:Date.now(),UserIds:JSON.stringify(e)}),this.send(t)},t.prototype.doSendMsgToPeer=function(e,t,n,r,o){void 0===r&&(r=!1),void 0===o&&(o=!1);var i=this;return new Promise((function(a,s){if(i._websocket&&1===i._websocket.readyState){var E=Date.now(),_=function(e){var t=e.data,n=JSON.parse(t),r=n.Cmd,o=(n.Encrypt,n.Content),s=JSON.parse(o),c=0;if(\"MsgStatus\"===r){var u=s.MsgId,l=s.Status;u===E&&(0===l?(i.removeMessageEventListener(_),a(!1)):1===l?c=setTimeout((function(){i.removeMessageEventListener(_),c&&clearTimeout(c),a(!1)}),1e4):2===l&&(i.removeMessageEventListener(_),c&&clearTimeout(c),a(!0)))}};i.addMessageEventListener(_);var c={Cmd:\"SendMsgToPeer\"};c.Encrypt=i._cmdEncrypt,c.Content=JSON.stringify(Object.assign({MsgId:E,FromUId:i._userId,ToUId:t,MsgType:e,MsgBody:n,OfflineMsg:r,HistoryMsg:o,Desc:\"\"})),i.send(c)}else s()}))},t.prototype.doRecvMsgFromPeerAck=function(e,t){if(!this._websocket||1!==this._websocket.readyState)return!1;var n={Cmd:\"RecvMsgFromPeerAck\"};n.Encrypt=this._cmdEncrypt,n.Content=JSON.stringify(Object.assign({MsgId:e,FromUId:t})),this.send(n)},t.prototype.doAddOrUpdateUserAttributes=function(e,t){void 0===t&&(t=!1);var n=this;return new Promise((function(r,o){var i=function(e){var t=e.data,a=JSON.parse(t),s=a.Cmd,E=(a.Encrypt,a.Content),_=JSON.parse(E);if(\"AddOrUpdateUserAttributes\"===s){n.removeMessageEventListener(i);var c=_.Code;_.MsgId;0===c?r(!0):o(c)}};n.addMessageEventListener(i);var a={Cmd:\"AddOrUpdateUserAttributes\"};a.Encrypt=n._cmdEncrypt,a.Content=JSON.stringify(Object.assign({MsgId:Date.now(),SetLocal:t,Attributes:JSON.stringify(e)})),n.send(a)}))},t.prototype.doDeleteUserAttributes=function(e){var t=this;return new Promise((function(n,r){var o=function(e){var i=e.data,a=JSON.parse(i),s=a.Cmd,E=(a.Encrypt,a.Content),_=JSON.parse(E);if(\"DeleteUserAttributes\"===s){t.removeMessageEventListener(o);var c=_.Code;_.MsgId;0===c?n(!0):r(c)}};t.addMessageEventListener(o);var i={Cmd:\"DeleteUserAttributes\"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({MsgId:Date.now(),Keys:JSON.stringify(e)})),t.send(i)}))},t.prototype.doClearUserAttributes=function(){var e=this;return new Promise((function(t,n){var r=function(o){var i=o.data,a=JSON.parse(i),s=a.Cmd,E=(a.Encrypt,a.Content),_=JSON.parse(E);if(\"ClearUserAttributes\"===s){e.removeMessageEventListener(r);var c=_.Code;_.MsgId;0===c?t(!0):n(c)}};e.addMessageEventListener(r);var o={Cmd:\"ClearUserAttributes\"};o.Encrypt=e._cmdEncrypt,o.Content=JSON.stringify(Object.assign({MsgId:Date.now()})),e.send(o)}))},t.prototype.doGetUserAttributes=function(e){var t=this;return new Promise((function(n,r){var o=function(r){var i=r.data,a=JSON.parse(i),s=a.Cmd,E=(a.Encrypt,a.Content),_=JSON.parse(E);if(\"QueryAttribKeys\"===s){var c=_.QueryUserId,u=(_.MsgId,_.Attribs);c===e&&(t.removeMessageEventListener(o),n(JSON.parse(\"\"!==u?u:[])))}};t.addMessageEventListener(o);var i={Cmd:\"GetUserAttributes\"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({MsgId:Date.now(),UserId:e})),t.send(i)}))},t.prototype.doGetUserAttributesByKeys=function(e,t){var n=this;return new Promise((function(r,o){var i=function(t){var o=t.data,a=JSON.parse(o),s=a.Cmd,E=(a.Encrypt,a.Content),_=JSON.parse(E);if(\"QueryAttribKeys\"===s){var c=_.QueryUserId,u=(_.MsgId,_.Attribs);c===e&&(n.removeMessageEventListener(i),r(JSON.parse(u)))}};n.addMessageEventListener(i);var a={Cmd:\"GetUserAttributes\"};a.Encrypt=n._cmdEncrypt,a.Content=JSON.stringify(Object.assign({MsgId:Date.now(),UserId:e,Keys:t})),n.send(a)}))},t.prototype.doJoinChannel=function(e){var t=this;return new Promise((function(n,r){var o=function(e){var i=e.data,a=JSON.parse(i),s=a.Cmd,E=(a.Encrypt,a.Content),_=JSON.parse(E);if(\"JoinChannel\"===s){t.removeMessageEventListener(o);var c=_.Code;_.ChanId;0===c?n():r(c)}};t.addMessageEventListener(o);var i={Cmd:\"JoinChannel\"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({ChanId:e})),t.send(i)}))},t.prototype.doSendChannelMsg=function(e,t,n,r){void 0===r&&(r=!1);var o=this;return new Promise((function(i,a){var s=Date.now(),E=function(e){var t=e.data,n=JSON.parse(t),r=n.Cmd,_=(n.Encrypt,n.Content),c=JSON.parse(_);if(\"SendChannelMsg\"===r){var u=c.Code,l=(c.ChanId,c.MsgId);s===l&&(o.removeMessageEventListener(E),0===u?i():a(u))}};o.addMessageEventListener(E);var _={Cmd:\"SendChannelMsg\"};_.Encrypt=o._cmdEncrypt,_.Content=JSON.stringify(Object.assign({ChanId:t,FromUId:o._userId,MsgId:s,MsgType:e,MsgBody:n,HistoryMsg:r,Desc:\"\"})),o.send(_)}))},t.prototype.doLeaveChannel=function(e){var t=this;return new Promise((function(n,r){var o=function(e){var i=e.data,a=JSON.parse(i),s=a.Cmd,E=(a.Encrypt,a.Content),_=JSON.parse(E);if(\"LeaveChannel\"===s){t.removeMessageEventListener(o);var c=_.Code;_.ChanId;0===c?n():r(c)}};t.addMessageEventListener(o);var i={Cmd:\"LeaveChannel\"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({ChanId:e})),t.send(i)}))},t.prototype.doAddOrUpdateChanAttributes=function(e){var t=this,n=e.channelId,r=e.attributes,o=e.notify,i=void 0!==o&&o,a=e.isSet,s=void 0!==a&&a;return new Promise((function(e,o){var a=function(n){var r=n.data,i=JSON.parse(r),s=i.Cmd,E=(i.Encrypt,i.Content),_=JSON.parse(E);if(\"AddOrUpdateChanAttributes\"===s){t.removeMessageEventListener(a);var c=_.Code;_.ChanId;0===c?e():o(c)}};t.addMessageEventListener(a);var E={Cmd:\"AddOrUpdateChanAttributes\"};E.Encrypt=t._cmdEncrypt,E.Content=JSON.stringify(Object.assign({MsgId:Date.now(),SetChan:s,ChanId:n,Attributes:JSON.stringify(r),Notify:i})),t.send(E)}))},t.prototype.doDeleteChanAttributes=function(e){var t=this,n=e.channelId,r=e.attributeKeys,o=e.notify;return new Promise((function(e,i){var a=function(n){var r=n.data,o=JSON.parse(r),s=o.Cmd,E=(o.Encrypt,o.Content),_=JSON.parse(E);if(\"DeleteChanAttributes\"===s){t.removeMessageEventListener(a);var c=_.Code;_.ChanId;0===c?e():i(c)}};t.addMessageEventListener(a);var s={Cmd:\"DeleteChanAttributes\"};s.Encrypt=t._cmdEncrypt,s.Content=JSON.stringify(Object.assign({MsgId:Date.now(),ChanId:n,Keys:JSON.stringify(r),Notify:o})),t.send(s)}))},t.prototype.doGetChanAttributes=function(e){var t=this;return new Promise((function(n,r){var o=function(i){var a=i.data,s=JSON.parse(a),E=s.Cmd,_=(s.Encrypt,s.Content),c=JSON.parse(_);if(\"GetChanAttributes\"===E){var u=c.Code,l=c.ChanId,R=c.Attributes;e===l&&(t.removeMessageEventListener(o),0===u?n(JSON.parse(\"\"===R?\"[]\":R)):r(u))}};t.addMessageEventListener(o);var i={Cmd:\"GetChanAttributes\"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({MsgId:Date.now(),ChanId:e})),t.send(i)}))},t.prototype.doGetChanAttributesByKeys=function(e,t){var n=this;return new Promise((function(r,o){var i=function(t){var a=t.data,s=JSON.parse(a),E=s.Cmd,_=(s.Encrypt,s.Content),c=JSON.parse(_);if(\"GetChanAttributesByKeys\"===E){var u=c.Code,l=c.ChanId,R=c.Attributes;e===l&&(n.removeMessageEventListener(i),0===u?r(\"\"!==R?JSON.parse(R):[]):o(u))}};n.addMessageEventListener(i);var a={Cmd:\"GetChanAttributesByKeys\"};a.Encrypt=n._cmdEncrypt,a.Content=JSON.stringify(Object.assign({MsgId:Date.now(),ChanId:e,Keys:JSON.stringify(t)})),n.send(a)}))},t.prototype.doClearChanAttributes=function(e){var t=this,n=e.channelId,r=e.notify;return new Promise((function(e,o){var i=function(n){var r=n.data,a=JSON.parse(r),s=a.Cmd,E=(a.Encrypt,a.Content),_=JSON.parse(E);if(\"ClearChanAttributes\"===s){t.removeMessageEventListener(i);var c=_.Code;_.MsgId;0===c?e(!0):o(c)}};t.addMessageEventListener(i);var a={Cmd:\"ClearChanAttributes\"};a.Encrypt=t._cmdEncrypt,a.Content=JSON.stringify(Object.assign({MsgId:Date.now(),ChanId:n,Notify:r})),t.send(a)}))},t.prototype.doGetChanMemberSize=function(e){var t=this;return new Promise((function(n,r){var o=function(e){var i=e.data,a=JSON.parse(i),s=a.Cmd,E=(a.Encrypt,a.Content),_=JSON.parse(E);if(\"GetChanMemberSize\"===s){t.removeMessageEventListener(o);var c=_.Code,u=_.ChanMemSize;_.MsgId;0===c?n(u):r(c)}};t.addMessageEventListener(o);var i={Cmd:\"GetChanMemberSize\"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({MsgId:Date.now(),ChanIds:JSON.stringify(e)})),t.send(i)}))},t.prototype.doGetChanMembers=function(e){var t=this;return new Promise((function(n,r){var o=function(i){var a=i.data,s=JSON.parse(a),E=s.Cmd,_=(s.Encrypt,s.Content),c=JSON.parse(_);if(\"GetChanMembers\"===E){var u=c.Code,l=c.Members,R=c.ChanId;c.MsgId;e===R&&(t.removeMessageEventListener(o),0===u?n(l):r(u))}};t.addMessageEventListener(o);var i={Cmd:\"GetChanMembers\"};i.Encrypt=t._cmdEncrypt,i.Content=JSON.stringify(Object.assign({MsgId:Date.now(),ChanId:e})),t.send(i)}))},t.prototype.doMakeCall=function(e,t,n){var r={Cmd:\"MakeCall\"};r.Encrypt=this._cmdEncrypt,r.Content=JSON.stringify(Object.assign({CallId:e,FromUId:this._userId,ToUId:t,Content:n})),this.send(r)},t.prototype.doCancelCall=function(e,t,n){var r={Cmd:\"CancelCall\"};r.Encrypt=this._cmdEncrypt,r.Content=JSON.stringify(Object.assign({CallId:e,FromUId:this._userId,ToUId:t,Content:n})),this.send(r)},t.prototype.doAcceptCall=function(e,t,n){var r={Cmd:\"AcceptCall\"};r.Encrypt=this._cmdEncrypt,r.Content=JSON.stringify(Object.assign({CallId:e,FromUId:this._userId,ToUId:t,Response:n})),this.send(r)},t.prototype.doRefuseCall=function(e,t,n){var r={Cmd:\"RejectCall\"};r.Encrypt=this._cmdEncrypt,r.Content=JSON.stringify(Object.assign({CallId:e,FromUId:this._userId,ToUId:t,Response:n})),this.send(r)},t.prototype.doReNewToken=function(e){var t={Cmd:\"RenewAcsToken\"};t.Content=JSON.stringify({AcsToken:e}),this.send(t)},t.prototype.disconnectServer=function(e){if(this._stopKeepAlive(),this._clearKeepALiveTimeout(),this.clear(),e)switch(e){case\"UID_BANNED\":this._emitConnectionState(\"DISCONNECTED\",\"UID_BANNED\");break;case\"TOKEN_INVALID\":this._emitConnectionState(\"DISCONNECTED\",\"TOKEN_INVALID\")}else this._emitConnectionState(\"DISCONNECTED\",\"LEAVE\")},t.prototype.clearEventEmitter=function(){this.removeAllListeners()},t.prototype._setConnectTimeout=function(){var e=this;e._clearConnectTimeout(),e._connectTimeout=setTimeout((function(){e._emitConnectionState(\"DISCONNECTING\",\"NETWORK_ERROR\")}),1e4)},t.prototype._startKeepAlive=function(){var e=this;e._stopKeepAlive(),e.doKeepAlive(),e._keepALiveInterval=setInterval((function(){e.doKeepAlive()}),e._keepALiveIntervalTime)},t.prototype._stopKeepAlive=function(){this._keepALiveInterval&&clearInterval(this._keepALiveInterval)},t.prototype._clearConnectTimeout=function(){this._connectTimeout&&clearTimeout(this._connectTimeout)},t.prototype._clearKeepALiveTimeout=function(){this._keepAliveTimeout&&(clearTimeout(this._keepAliveTimeout),this._keepAliveTimeout=0)},t.prototype._emitConnectionState=function(e,t){\"DISCONNECTED\"===e&&c.debug(\"[signal] media websocket closed, reason: \"+t),this._revState=this._curState,this._curState=e,this.handleMediaServerEvents&&this.handleMediaServerEvents(\"connection-state-change\",{curState:this._curState,revState:this._revState,reason:t})},t}(v),w=function(e){var t=\"function\"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&\"number\"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")},D=Array.prototype,G=function(){function e(){this._events={},this.addListener=this.on}return e.prototype.getListeners=function(e){return this._events[e]?D.map.call(this._events[e],(function(e){return e.listener})):[]},e.prototype.on=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!1})},e.prototype.once=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!0})},e.prototype.off=function(e,t){this._events[e]||(this._events[e]=[]);var n=this._events[e],r=this._indexOfListener(n,t);-1!==r&&D.splice.call(n,r,1)},e.prototype.removeAllListeners=function(e){e?delete this._events[e]:this._events={}},e.prototype.emit=function(e){for(var t,n,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];this._events[e]||(this._events[e]=[]);var i=this._events[e];try{for(var a=w(i),s=a.next();!s.done;s=a.next()){var E=s.value;E.once&&this.off(e,E.listener),E.listener.apply(this,r||[])}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}},e.prototype._indexOfListener=function(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1},e}(),P=n(1),B=n(0),F=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),V=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{E(r.next(e))}catch(e){i(e)}}function s(e){try{E(r.throw(e))}catch(e){i(e)}}function E(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}E((r=r.apply(e,t||[])).next())}))},J=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},k=function(e){function t(t,n){var r=e.call(this)||this;return r.memberCount=0,r.attributes={},r.channelId=\"\",r.client=t,r.channelId=n,r.bindChannelEvents=r._handleChannelEvents.bind(r),r}return F(t,e),t.prototype.getMembers=function(){return V(this,void 0,void 0,(function(){var e,t;return J(this,(function(n){switch(n.label){case 0:return t=(e=this).client._rtmServer,\"\"===this.client.uid?[3,2]:[4,t.doGetChanMembers(e.channelId)];case 1:return[2,n.sent()];case 2:throw new y(B.a.GetMembersError.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in. Cannot do the operation.\")}}))}))},t.prototype.join=function(){return V(this,void 0,void 0,(function(){var e,t;return J(this,(function(n){switch(n.label){case 0:if(e=this,\"\"===this.client.uid)throw new y(B.a.JoinChannelError.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in. Cannot do the operation.\");return e.client.channels[e.channelId].joined?[3,3]:(t=e.client._rtmServer)?(t.addMessageEventListener(this.bindChannelEvents),[4,t.doJoinChannel(e.channelId)]):[3,2];case 1:return n.sent(),e.client.channels[e.channelId].joined=!0,e.client._gateway.getChanHistoryMsg({chanId:e.channelId}).then((function(t){var n=t.code,r=t.data;0===n&&r.map((function(t){var n=t.msgFrom,r=(t.msgStatus,t.msgType),o=t.msgBody,i={isHistoricalMessage:!0,isOfflineMessage:!1,serverReceivedTs:t.msgTs};if(1===r){var a={text:o};e.emit(\"ChannelMessage\",a,n,i)}else if(2===r){a={rawMessage:Base64.toUint8Array(o)};e.emit(\"ChannelMessage\",a,n,i)}}))})).catch(),[2];case 2:return[3,4];case 3:throw new L(B.a.JoinChannelError.JOIN_CHANNEL_ERR_ALREADY_JOINED,\"The channel has joined. Cannot rejoin.\");case 4:return[2]}}))}))},t.prototype.leave=function(){return V(this,void 0,void 0,(function(){var e,t,n;return J(this,(function(r){switch(r.label){case 0:if(e=this,\"\"===this.client.uid)throw new y(B.a.JoinChannelError.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in. Cannot do the operation.\");return(t=e.client.channels[e.channelId]).joined?(n=e.client._rtmServer)?[4,n.doLeaveChannel(e.channelId)]:[3,2]:[3,3];case 1:return r.sent(),t.joined=!1,n.removeMessageEventListener(e.bindChannelEvents),[2];case 2:return[3,4];case 3:throw new L(B.a.LeaveChannelError.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL,\"The channel does not join. Cannot do the operation.\");case 4:return[2]}}))}))},t.prototype.sendMessage=function(e,t){return V(this,void 0,void 0,(function(){var n,r,o,i;return J(this,(function(a){switch(a.label){case 0:if(n=this,\"\"===this.client.uid)throw new y(B.a.ChannelMessageError.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in. Cannot do the operation.\");return n.client.channels[n.channelId].joined?(r=(t||{enableHistoricalMessaging:!1}).enableHistoricalMessaging,(o=n.client._rtmServer)?(e.messageType,(i=e.text)?(P.a.MessageType.TEXT,[4,o.doSendChannelMsg(1,n.channelId,i,r)]):[3,2]):[3,3]):[3,4];case 1:return a.sent(),[2];case 2:throw new y(B.a.ChannelMessageError.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE,\"Message is not valid.\");case 3:return[3,5];case 4:throw new L(B.a.ChannelMessageError.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL,\"The channel does not join. Cannot do the operation.\");case 5:return[2]}}))}))},t.prototype._handleChannelEvents=function(e){var t=e.data,n=JSON.parse(t),r=n.Cmd,o=(n.Encrypt,n.Content),i=JSON.parse(o);if(i.ChanId===this.channelId)if(\"RecvMsgFromChan\"===r){i.MsgId;var a=i.FromUId,s=i.MsgType,E=i.MsgBody,_={isHistoricalMessage:!1,isOfflineMessage:!1,serverReceivedTs:i.SvrTS};if(1===s){var c={text:E};this.emit(\"ChannelMessage\",c,a,_)}else if(2===s){c={rawMessage:Base64.toUint8Array(E)};this.emit(\"ChannelMessage\",c,a,_)}}else if(\"ChanMemberJoin\"===r){var u=i.UserId;i.ChanMemSize;this.emit(\"MemberJoined\",u)}else if(\"ChanMemberLeave\"===r){u=i.UserId,i.ChanMemSize;this.emit(\"MemberLeft\",u)}else if(\"MemSizeChanged\"===r){var l=i.MemSize;this.emit(\"MemberCountUpdated\",l)}else if(\"ChanAttribChanged\"===r){var R=i.Attributes,N={};R.map((function(e){var t=e.Key,n=e.Val,r=e.UId,o=e.Time;N[t]={lastUpdateTs:o,lastUpdateUserId:r,value:n}})),this.emit(\"AttributesUpdated\",N)}},t}(G),j=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),H=function(e){function t(t,n,r){var o=e.call(this)||this;return o._callId=\"\",o.calleeId=\"\",o.content=\"\",o.state=P.a.LocalInvitationState.IDLE,o.response=\"\",o.client=t,o._callId=n,o.calleeId=r,o}return j(t,e),t.prototype.cancel=function(){var e=this.client._rtmServer;if(e)if(this.state===P.a.LocalInvitationState.ACCEPTED_BY_REMOTE||this.state===P.a.LocalInvitationState.SENT_TO_REMOTE||this.state===P.a.LocalInvitationState.FAILURE||this.state===P.a.LocalInvitationState.RECEIVED_BY_REMOTE)e.doCancelCall(this._callId,this.calleeId),this.emit(\"LocalInvitationCanceled\");else if(this.state===P.a.LocalInvitationState.IDLE)throw new L(B.a.InvitationApiCallError.INVITATION_API_CALL_ERR_NOT_STARTED,\"The call invitation is not send yet.\")},t.prototype.send=function(){if(this.state!==P.a.LocalInvitationState.IDLE){if(this.state===P.a.LocalInvitationState.SENT_TO_REMOTE)throw new L(B.a.InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_SENT,\"The call invitation already sent.\");if(this.state===P.a.LocalInvitationState.ACCEPTED_BY_REMOTE||this.state===P.a.LocalInvitationState.REFUSED_BY_REMOTE)throw new L(B.a.InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_END,\"The call invitation already by accept.\")}var e=this.client._rtmServer;e?e.doMakeCall(this._callId,this.calleeId,this.content):this.emit(\"LocalInvitationFailure\",P.a.LocalInvitationFailureReason.NOT_LOGGEDIN)},t}(G),x=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Y=function(e){function t(t,n,r){var o=e.call(this)||this;return o._callId=\"\",o.callerId=\"\",o.content=\"\",o.response=\"\",o._callId=t,o.callerId=n,o.content=r,o.state=P.a.RemoteInvitationState.INVITATION_RECEIVED,o}return x(t,e),t.prototype.accept=function(){var e=this.client._rtmServer;if(e)if(this.state===P.a.RemoteInvitationState.INVITATION_RECEIVED)e.doAcceptCall(this._callId,this.callerId,this.response),this.state=P.a.RemoteInvitationState.ACCEPT_SENT_TO_LOCAL;else{if(this.state===P.a.RemoteInvitationState.ACCEPTED)throw new L(B.a.InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_ACCEPT,\"The call invitation already by accept.\");if(this.state===P.a.RemoteInvitationState.REFUSED)throw new L(B.a.InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_END,\"The call invitation already ended.\")}},t.prototype.refuse=function(){var e=this.client._rtmServer;e&&this.state===P.a.RemoteInvitationState.INVITATION_RECEIVED&&(e.doRefuseCall(this._callId,this.callerId,this.response),this.state=P.a.RemoteInvitationState.REFUSED,this.emit(\"RemoteInvitationRefused\"))},t}(G),K=function(e){return e.then((function(e){return[null,e]})).catch((function(e){return[e]}))},W=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Q=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{E(r.next(e))}catch(e){i(e)}}function s(e){try{E(r.throw(e))}catch(e){i(e)}}function E(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}E((r=r.apply(e,t||[])).next())}))},z=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},X=function(e,t){var n=\"function\"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},$=function(e){var t=\"function\"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&\"number\"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")},Z=function(e){function t(t,n){var r=e.call(this)||this;r._useWss=!0,r._userAttributes={},r._localCall={},r._remoteCall={},r._sessionId=\"\",r._joinStartTime=0,r.uid=\"\",r.token=null,r.channels={},r.channelAttributesCacheLru={},r._sid=a.generateLowCaseString(32),r._appId=t;var i=(n||{}).confPriCloudAddr;if(i){var s=i.ServerAdd,E=i.Port,_=i.Wss;r._useWss=\"boolean\"!=typeof _||_,s&&(o.GATEWAY_ADDRESS=(r._useWss?\"https://\"+s:\"http://\"+s)+(E?\":\"+E:\"\"))}return r}return W(t,e),t.prototype.addOrUpdateChannelAttributes=function(e,t,n){var r;return Q(this,void 0,void 0,(function(){var o,i,a;return z(this,(function(s){switch(s.label){case 0:if(o=this,i=/^[a-zA-Z0-9 \\!\\#\\$\\%\\&\\(\\)\\+\\-\\:\\;\\<\\=\\.\\>\\?\\@\\[\\]\\^\\_\\{\\}\\|\\~\\,]{1,64}$/,\"string\"!=typeof e||!i.test(e))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The attributes in the arguments is invalid.\");if(\"[object Object]\"!==Object.prototype.toString.call(t)||\"{}\"===JSON.stringify(t))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The attributes in the arguments is invalid.\");return Object.keys(t).forEach((function(e){if(null==e||\"\"===e)throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"Invalid attribute key.\")})),Object.values(t).map((function(e,t){if(null==e||\"\"===e)throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"Invalid attribute key.\")})),\"\"===o.uid?[3,2]:(a=(n||{enableNotificationToChannelMembers:!1}).enableNotificationToChannelMembers,[4,null===(r=o._rtmServer)||void 0===r?void 0:r.doAddOrUpdateChanAttributes({channelId:e,attributes:t,notify:a})]);case 1:return s.sent(),o.channelAttributesCacheLru[e]=t,[2];case 2:throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}}))}))},t.prototype.addOrUpdateLocalUserAttributes=function(e){var t;return Q(this,void 0,void 0,(function(){var n;return z(this,(function(r){switch(r.label){case 0:if(n=this,\"[object Object]\"!==Object.prototype.toString.call(e)||\"{}\"===JSON.stringify(e))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The attributes in the arguments is invalid.\");return Object.keys(e).forEach((function(e){if(null==e||\"\"===e)throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"Invalid attribute value.\")})),Object.values(e).map((function(e,t){if(null==e||\"\"===e)throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"Invalid attribute key.\")})),\"\"===n.uid?[3,2]:[4,null===(t=n._rtmServer)||void 0===t?void 0:t.doAddOrUpdateUserAttributes(e)];case 1:return r.sent(),n._userAttributes=e,[2];case 2:throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}}))}))},t.prototype.clearChannelAttributes=function(e,t){var n;return Q(this,void 0,void 0,(function(){var r,o,i;return z(this,(function(a){switch(a.label){case 0:if(r=this,o=/^[a-zA-Z0-9 \\!\\#\\$\\%\\&\\(\\)\\+\\-\\:\\;\\<\\=\\.\\>\\?\\@\\[\\]\\^\\_\\{\\}\\|\\~\\,]{1,64}$/,\"string\"!=typeof e||!o.test(e))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The attributes in the arguments is invalid.\");return\"\"===r.uid?[3,2]:(i=(t||{enableNotificationToChannelMembers:!1}).enableNotificationToChannelMembers,[4,null===(n=r._rtmServer)||void 0===n?void 0:n.doClearChanAttributes({channelId:e,notify:i})]);case 1:return a.sent(),r.channelAttributesCacheLru[e]&&delete r.channelAttributesCacheLru[e],[2];case 2:throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}}))}))},t.prototype.clearLocalUserAttributes=function(){var e;return Q(this,void 0,void 0,(function(){var t;return z(this,(function(n){switch(n.label){case 0:return\"\"===(t=this).uid?[3,2]:[4,null===(e=t._rtmServer)||void 0===e?void 0:e.doClearUserAttributes()];case 1:return n.sent(),t._userAttributes={},[2];case 2:throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}}))}))},t.prototype.createChannel=function(e){if(\"string\"!=typeof e||!/^[a-zA-Z0-9 \\!\\#\\$\\%\\&\\(\\)\\+\\-\\:\\;\\<\\=\\.\\>\\?\\@\\[\\]\\^\\_\\{\\}\\|\\~\\,]{1,64}$/.test(e))throw new y(B.a.CreateChannelError.CREATE_CHANNEL_ERR_INVALID_ARGUMENT,\"The channelId in the arguments is invalid.\");var t=new k(this,e);return this.channels[e]={channel:t,joined:!1},t},t.prototype.createLocalInvitation=function(e){if(\"string\"!=typeof e)throw new y(B.a.InvitationApiCallError.INVITATION_API_CALL_ERR_INVALID_ARGUMENT,\"The calleeId in the arguments is invalid.\");var t=a.generateLowCaseString(32),n=new H(this,t,e);return this._localCall[t]=n,n},t.prototype.deleteChannelAttributesByKeys=function(e,t,n){var r;return Q(this,void 0,void 0,(function(){var o,i,a,s;return z(this,(function(E){switch(E.label){case 0:if(\"\"===(o=this).uid)return[3,2];if(i=/^[a-zA-Z0-9 \\!\\#\\$\\%\\&\\(\\)\\+\\-\\:\\;\\<\\=\\.\\>\\?\\@\\[\\]\\^\\_\\{\\}\\|\\~\\,]{1,64}$/,\"string\"!=typeof e||!i.test(e))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The channelId in the arguments is invalid.\");if(!(t instanceof Array))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The attributeKeys in the arguments is not valid.\");return a=(n||{enableNotificationToChannelMembers:!1}).enableNotificationToChannelMembers,[4,null===(r=o._rtmServer)||void 0===r?void 0:r.doDeleteChanAttributes({channelId:e,attributeKeys:t,notify:a})];case 1:return E.sent(),o.channelAttributesCacheLru[e]&&(s=o.channelAttributesCacheLru[e],Object.keys(s).map((function(e){s.hasOwnProperty(e)&&delete s[e]}))),[2];case 2:throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}}))}))},t.prototype.deleteLocalUserAttributesByKeys=function(e){var t;return Q(this,void 0,void 0,(function(){var n;return z(this,(function(r){switch(r.label){case 0:if(n=this,!(e instanceof Array))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The attributeKeys in the arguments is not valid.\");return\"\"===n.uid?[3,2]:[4,null===(t=n._rtmServer)||void 0===t?void 0:t.doDeleteUserAttributes(e)];case 1:return r.sent(),e.map((function(e){n._userAttributes.hasOwnProperty(e)&&delete n._userAttributes[e]})),[2];case 2:throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}}))}))},t.prototype.getChannelAttributes=function(e){var t;return Q(this,void 0,void 0,(function(){var n,r,o,i,a;return z(this,(function(s){switch(s.label){case 0:if(n=this,r=/^[a-zA-Z0-9 \\!\\#\\$\\%\\&\\(\\)\\+\\-\\:\\;\\<\\=\\.\\>\\?\\@\\[\\]\\^\\_\\{\\}\\|\\~\\,]{1,64}$/,\"string\"!=typeof e||!r.test(e))throw new y(B.a.CreateChannelError.CREATE_CHANNEL_ERR_INVALID_ARGUMENT,\"The channelId in the arguments is invalid.\");return\"\"===n.uid?[3,2]:[4,null===(t=n._rtmServer)||void 0===t?void 0:t.doGetChanAttributes(e)];case 1:return o=s.sent(),i={},a={},o.map((function(e){var t=e.Key,n=e.Val,r=e.UId,o=e.Time;i[t]=n,a[t]={lastUpdateTs:o,lastUpdateUserId:r,value:n}})),n.channelAttributesCacheLru[e]=i,[2,a];case 2:throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}}))}))},t.prototype.getChannelAttributesByKeys=function(e,t){var n;return Q(this,void 0,void 0,(function(){var r,o,i,a,s;return z(this,(function(E){switch(E.label){case 0:if(r=this,o=/^[a-zA-Z0-9 \\!\\#\\$\\%\\&\\(\\)\\+\\-\\:\\;\\<\\=\\.\\>\\?\\@\\[\\]\\^\\_\\{\\}\\|\\~\\,]{1,64}$/,\"string\"!=typeof e||!o.test(e))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The channelId in the arguments is invalid.\");if(!(t instanceof Array))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The attributeKeys in the arguments is not valid.\");return\"\"===r.uid?[3,2]:[4,null===(n=r._rtmServer)||void 0===n?void 0:n.doGetChanAttributesByKeys(e,t)];case 1:return i=E.sent(),a=r.channelAttributesCacheLru[e]||{},s={},i.map((function(e){var t=e.Key,n=e.Val,r=e.UId,o=e.Time;s[t]={lastUpdateTs:o,lastUpdateUserId:r,value:n},a[t]=n})),[2,s];case 2:throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}}))}))},t.prototype.getChannelMemberCount=function(e){var t;return Q(this,void 0,void 0,(function(){var n,r;return z(this,(function(o){switch(o.label){case 0:if(n=this,\"[object Array]\"!==Object.prototype.toString.call(e))throw new y(B.a.GetChannelMemberCountErrCode.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT,\"The channelIds in the arguments is invalid.\");if(e.length>32)throw new y(B.a.GetChannelMemberCountErrCode.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT,\"The channelIds is out of length.\");return\"\"===n.uid?[3,4]:n._rtmServer?(r={},[4,null===(t=n._rtmServer)||void 0===t?void 0:t.doGetChanMemberSize(e)]):[3,2];case 1:return o.sent().map((function(e){r[e.ChanId]=e.MemSize})),[2,r];case 2:throw new y(B.a.GetChannelMemberCountErrCode.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED,\"The RTM server is not initialized yet.\");case 3:return[3,5];case 4:throw new y(B.a.GetChannelMemberCountErrCode.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\");case 5:return[2]}}))}))},t.prototype.getUserAttributes=function(e){var t;return Q(this,void 0,void 0,(function(){var n;return z(this,(function(r){switch(r.label){case 0:if(n=this,\"string\"!=typeof e)throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The channelId in the arguments is invalid.\");return\"\"===n.uid?[3,2]:[4,null===(t=n._rtmServer)||void 0===t?void 0:t.doGetUserAttributes(e)];case 1:return[2,r.sent()];case 2:throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}}))}))},t.prototype.getUserAttributesByKeys=function(e,t){var n=this,r=this;return new Promise((function(o,i){return Q(n,void 0,void 0,(function(){var n,i;return z(this,(function(a){switch(a.label){case 0:if(\"\"===r.uid)return[3,2];if(\"string\"!=typeof e||!(t instanceof Array))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"arguments is not valid.\");return[4,null===(i=r._rtmServer)||void 0===i?void 0:i.doGetUserAttributesByKeys(e,t)];case 1:return n=a.sent(),o(n),[3,3];case 2:throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\");case 3:return[2]}}))}))}))},t.prototype.login=function(e){var t=this,n=this;return new Promise((function(r,o){return Q(t,void 0,void 0,(function(){var t,i,a,s;return z(this,(function(E){switch(E.label){case 0:return\"\"!==n.uid?(o(new L(B.a.LoginError.LOGIN_ERR_ALREADY_LOGIN,\"The SDK is either logging in or has logged in the RTM system.\")),[2]):(t=e.token,i=e.uid,n._emitConnectionState(P.a.ConnectionState.CONNECTING,P.a.ConnectionChangeReason.LOGIN),a=/^[a-zA-Z0-9 \\!\\#\\$\\%\\&\\(\\)\\+\\-\\:\\;\\<\\=\\.\\>\\?\\@\\[\\]\\^\\_\\{\\}\\|\\~\\,]{1,64}$/,\"\"===i||null==i||a.test(i)&&\"string\"==typeof i?t&&\"string\"!=typeof t?(o(new y(B.a.LoginError.LOGIN_ERR_INVALID_ARGUMENT,\"The uid length must be string within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,\")),[2]):(this._joinStartTime=Date.now(),n._createRtmServerInstance(),[4,n._authGateWay(i,t).catch((function(e){switch(e.code){case B.a.LoginError.LOGIN_ERR_INVALID_ARGUMENT:s=P.a.ConnectionChangeReason.LOGIN_FAILURE;break;case B.a.LoginError.LOGIN_ERR_INVALID_APP_ID:s=P.a.ConnectionChangeReason.BANNED_BY_SERVER;case B.a.LoginError.LOGIN_ERR_TIMEOUT:s=P.a.ConnectionChangeReason.LOGIN_TIMEOUT}n._emitConnectionState(P.a.ConnectionState.DISCONNECTED,s),o(e)}))]):(o(new y(B.a.LoginError.LOGIN_ERR_INVALID_ARGUMENT,\"The uid length must be string within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,\")),[2]));case 1:return E.sent()?r():o(),[2]}}))}))}))},t.prototype.logout=function(){var e;return Q(this,void 0,void 0,(function(){return z(this,(function(t){switch(t.label){case 0:return\"\"===this.uid?[3,2]:[4,null===(e=this._rtmServer)||void 0===e?void 0:e.doOffline()];case 1:return t.sent(),this._rtmServer.disconnectServer(),this._rtmServer.handleMediaServerEvents=function(){},this._rtmServer=void 0,this.uid=\"\",this.channels={},this._localCall={},this._remoteCall={},this._sessionId=\"\",this.token=\"\",this._joinStartTime=0,this._emitConnectionState(P.a.ConnectionState.DISCONNECTED,P.a.ConnectionChangeReason.LOGOUT),[2];case 2:throw new L(B.a.LogoutError.LOGOUT_ERR_USER_NOT_LOGGED_IN,\"Logout failure. The client has already been logged out.\")}}))}))},t.prototype.queryPeersBySubscriptionOption=function(e){var t;return Q(this,void 0,void 0,(function(){var n;return z(this,(function(r){switch(r.label){case 0:if(\"\"===this.uid)throw new y(B.a.QueryPeersBySubscriptionOptionError.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in. Cannot do the operation\");if(!(e in P.a.PeerSubscriptionOption))throw new y(B.a.QueryPeersBySubscriptionOptionError.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE,\"\");return n=[],P.a.PeerSubscriptionOption.ONLINE_STATUS!==e?[3,2]:[4,null===(t=this._rtmServer)||void 0===t?void 0:t.doQueryOnlineSubStatus()];case 1:r.sent().map((function(e){1===e.Online&&n.push(e.UserId)})),r.label=2;case 2:return[2,n]}}))}))},t.prototype.queryPeersOnlineStatus=function(e){var t;return Q(this,void 0,void 0,(function(){var n;return z(this,(function(r){switch(r.label){case 0:if(n={},\"\"===this.uid)return[3,2];if(!(e instanceof Array&&e))throw new L(B.a.QueryPeersOnlineStatusError.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT,\"invalid arguments.\");return[4,null===(t=this._rtmServer)||void 0===t?void 0:t.doQueryOnlineStatus(e)];case 1:return r.sent().map((function(e){n[e.UserId]=!!e.Online})),[2,n];case 2:throw new L(B.a.QueryPeersOnlineStatusError.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}}))}))},t.prototype.renewToken=function(e){return Q(this,void 0,void 0,(function(){var t;return z(this,(function(n){return t=this,[2,new Promise((function(n,r){var o;try{if(\"\"===t.uid)throw new L(B.a.RenewTokenError.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN,\"renewToken should not be called before user join\");if(e&&\"string\"!=typeof e)return void r(new y(B.a.RenewTokenError.RENEW_TOKEN_ERR_INVALID_ARGUMENT,\"The uid length must be string within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,\"));c.info(\"set new token\"),null===(o=t._rtmServer)||void 0===o||o.doReNewToken(e),n()}catch(e){r(e)}}))]}))}))},t.prototype.sendMessageToPeer=function(e,t,n){var r;return Q(this,void 0,void 0,(function(){var o,i,a,s,E,_,c,u;return z(this,(function(l){switch(l.label){case 0:if(i={hasPeerReceived:!1},\"\"===(o=this).uid)return[3,4];if(!t)throw new y(B.a.PeerMessageError.PEER_MESSAGE_ERR_INVALID_USERID,\"The send message arguments are not valid.\");if(e.messageType,a=e.text,s=/^[a-zA-Z0-9 \\!\\#\\$\\%\\&\\(\\)\\+\\-\\:\\;\\<\\=\\.\\>\\?\\@\\[\\]\\^\\_\\{\\}\\|\\~\\,]{1,64}$/,\"\"!==t&&null!=t&&(!s.test(t)||\"string\"!=typeof t))throw new y(B.a.PeerMessageError.PEER_MESSAGE_ERR_INVALID_USERID,\"The uid length must be string within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,\");return _=(E=n||{enableHistoricalMessaging:!1,enableOfflineMessaging:!1}).enableHistoricalMessaging,c=E.enableOfflineMessaging,a?(P.a.MessageType.TEXT,[4,null===(r=o._rtmServer)||void 0===r?void 0:r.doSendMsgToPeer(1,t,a,c,_)]):[3,2];case 1:return u=l.sent(),i.hasPeerReceived=u,[2,i];case 2:throw new L(B.a.PeerMessageError.PEER_MESSAGE_ERR_INVALID_MESSAGE,\"Message is not valid.\");case 3:return[3,5];case 4:throw new L(B.a.PeerMessageError.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN,\"Failed to send the peer-to-peer message. The client is not logged in.\");case 5:return[2]}}))}))},t.prototype.setChannelAttributes=function(e,t,n){return Q(this,void 0,void 0,(function(){var r,o,i;return z(this,(function(a){switch(a.label){case 0:if(r=this,o=/^[a-zA-Z0-9 \\!\\#\\$\\%\\&\\(\\)\\+\\-\\:\\;\\<\\=\\.\\>\\?\\@\\[\\]\\^\\_\\{\\}\\|\\~\\,]{1,64}$/,\"string\"!=typeof e||!o.test(e))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The channelId in the arguments is invalid.\");if(\"[object Object]\"!==Object.prototype.toString.call(t))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The attributes in the arguments is invalid.\");return\"\"===r.uid?[3,3]:(i=(n||{enableNotificationToChannelMembers:!1}).enableNotificationToChannelMembers,r._rtmServer?[4,r._rtmServer.doAddOrUpdateChanAttributes({channelId:e,attributes:t,isSet:!0,notify:i})]:[3,2]);case 1:return a.sent(),r.channelAttributesCacheLru[e]=t,[2];case 2:return[3,4];case 3:throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\");case 4:return[2]}}))}))},t.prototype.setLocalUserAttributes=function(e){var t;return Q(this,void 0,void 0,(function(){var n;return z(this,(function(r){switch(r.label){case 0:if(n=this,\"[object Object]\"!==Object.prototype.toString.call(e))throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,\"The attributes in the arguments is invalid.\");return\"\"===n.uid?[3,2]:(n._userAttributes={},[4,null===(t=n._rtmServer)||void 0===t?void 0:t.doAddOrUpdateUserAttributes(e,!0)]);case 1:return r.sent(),n._userAttributes=e,[2];case 2:throw new y(B.a.AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}}))}))},t.prototype.setParameters=function(e){var t=e.confPriCloudAddr,n=e.ConfPriCloudAddr;if(t){var r=t.ServerAdd,i=t.Port,a=t.Wss;this._useWss=\"boolean\"!=typeof a||a,r&&(o.GATEWAY_ADDRESS=(this._useWss?\"https://\"+r:\"http://\"+r)+(i?\":\"+i:\"\"))}if(n){r=n.ServerAdd,i=n.Port,a=n.Wss;this._useWss=\"boolean\"!=typeof a||a,r&&(o.GATEWAY_ADDRESS=(this._useWss?\"https://\"+r:\"http://\"+r)+(i?\":\"+i:\"\"))}},t.prototype.subscribePeersOnlineStatus=function(e){var t;return Q(this,void 0,void 0,(function(){return z(this,(function(n){if(\"\"!==this.uid){if(!(e instanceof Array&&e))throw new L(B.a.PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT,\"invalid arguments.\");if(e.length>512)throw new L(B.a.PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW,\"Subscribe user out of length 512.\");return null===(t=this._rtmServer)||void 0===t||t.doSubscribeOnlineStatus(e),[2]}throw new y(B.a.PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}))}))},t.prototype.unsubscribePeersOnlineStatus=function(e){var t;return Q(this,void 0,void 0,(function(){return z(this,(function(n){if(\"\"!==this.uid){if(!(e instanceof Array&&e))throw new L(B.a.PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT,\"invalid arguments.\");return null===(t=this._rtmServer)||void 0===t||t.doUnSubscribeOnlineStatus(e),[2]}throw new y(B.a.PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN,\"The client is not logged in.\")}))}))},t.prototype._emitConnectionState=function(e,t){this.emit(\"ConnectionStateChanged\",e,t)},t.prototype._createRtmServerInstance=function(){var e=this;this._rtmServer||(this._rtmServer=new M),this._rtmServer.handleMediaServerEvents=function(t,n){var r,o,i=e;n.Code;if(\"connection-state-change\"===t){var a=n.curState;n.reason;if(\"RECONNECTING\"===a){i._emitConnectionState(P.a.ConnectionState.RECONNECTING);var s=i._userAttributes;new Set;i._userAttributes={},i._remoteCall={},i._localCall={},i.channelAttributesCacheLru={},Object.keys(i.channels).map((function(e){i.channels[e].joined=!1})),i._rtmServer=void 0,i._createRtmServerInstance(),i._authGateWay(i.uid,i.token).then((function(e){i.setLocalUserAttributes(s),Object.keys(i.channels).map((function(e){i.channels[e].channel.join()}))}))}}else if(\"ForceOffline\"===t||\"AcsTokenDidExpire\"===t)\"ForceOffline\"===t?e._emitConnectionState(P.a.ConnectionState.DISCONNECTED,P.a.ConnectionChangeReason.REMOTE_LOGIN):\"AcsTokenDidExpire\"===t&&(i.emit(\"TokenDidExpired\"),c.debug(\"[client}] token privilege did expire.\")),null===(r=i._rtmServer)||void 0===r||r.doOffline(),e._rtmServer.disconnectServer(\"TOKEN_INVALID\"),e._rtmServer.handleMediaServerEvents=function(){},e._rtmServer=void 0,e.uid=\"\",e.channels={},e._localCall={},e._remoteCall={},e._sessionId=\"\",e.token=\"\";else if(\"AcsTokenWillExpire\"===t)i.emit(\"TokenWillExpired\"),c.debug(\"[client] token privilege will expire.\");else if(\"RecvMsgFromPeer\"===t){var E=n.MsgId,_=n.FromUId,u=n.MsgType,l=n.MsgBody,R={isHistoricalMessage:!1,isOfflineMessage:!1,serverReceivedTs:n.SvrTS};if(1===u){var N={text:l};i.emit(\"MessageFromPeer\",N,_,R)}null===(o=i._rtmServer)||void 0===o||o.doRecvMsgFromPeerAck(E,_)}else if(\"PeerOnlineStatus\"===t){var d=n.Status,f={};d.map((function(e){f[e.UserId]=e.Online?P.a.PeerOnlineState.ONLINE:P.a.PeerOnlineState.OFFLINE})),i.emit(\"PeersOnlineStatusChanged\",f)}else if(\"MakeCall\"===t){var I=n.CallId,O=n.FromUId,T=(n.ToUId,n.Content);(v=new Y(I,O,T)).client=i,i._remoteCall[I]=v,i.emit(\"RemoteInvitationReceived\",v)}else if(\"CancelCall\"===t){I=n.CallId,O=n.FromUId,n.ToUId;var h=n.Reason,p=n.Response;(v=i._remoteCall[I]).state=P.a.RemoteInvitationState.CANCELED,h&&\"Offline\"===h?v.emit(\"RemoteInvitationFailure\",P.a.RemoteInvitationFailureReason.PEER_OFFLINE):v.emit(\"RemoteInvitationCanceled\",p)}else if(\"AcceptCallAck\"===t){var v;I=n.CallId;(v=i._remoteCall[I]).state=P.a.RemoteInvitationState.ACCEPTED,v.emit(\"RemoteInvitationAccepted\")}else if(\"AcceptCall\"===t){I=n.CallId,O=n.FromUId,n.ToUId;var A=n.Response;(C=i._localCall[I]).state=P.a.LocalInvitationState.ACCEPTED_BY_REMOTE,C.emit(\"LocalInvitationAccepted\",A)}else if(\"RejectCall\"===t){I=n.CallId,O=n.FromUId,n.ToUId;var S=n.Response;(C=i._localCall[I]).state=P.a.LocalInvitationState.REFUSED_BY_REMOTE,C.emit(\"LocalInvitationRefused\",S)}else if(\"CallStatus\"===t){I=n.CallId,d=n.Status;var C=i._localCall[I];if(1===d)C.state=P.a.LocalInvitationState.SENT_TO_REMOTE;else if(2===d)C.state=P.a.LocalInvitationState.RECEIVED_BY_REMOTE,C.emit(\"LocalInvitationReceivedByPeer\");else if(3===d){C.state=P.a.LocalInvitationState.FAILURE;var L=P.a.LocalInvitationFailureReason.PEER_OFFLINE;C.emit(\"LocalInvitationFailure\",L)}else if(4===d){C.state=P.a.LocalInvitationState.FAILURE;var y=P.a.LocalInvitationFailureReason.PEER_NO_RESPONSE;C.emit(\"LocalInvitationFailure\",y),i._localCall[I].cancel()}}}},t.prototype._authGateWay=function(e,t){var n=this,r=this;return new Promise((function(i,a){return Q(n,void 0,void 0,(function(){var n,s,E,u,l,R,N,d,f,O,T,h,p,v,A,S,C,y,m,g,b;return z(this,(function(U){switch(U.label){case 0:return n=new I,this._gateway=n,[4,K(n.joinGateway({appid:r._appId,uid:e,token:t||\"\",wss:r._useWss}))];case 1:return s=X.apply(void 0,[U.sent(),2]),E=s[0],u=s[1],E?(E===_.INVALID_PARAMS?a(new L(B.a.LoginError.LOGIN_ERR_INVALID_ARGUMENT,\"gateway connect failed: \")):E===_.DEVELOPER_INVALID||E===_.UID_BANNED||E===_.IP_BANNED||E===_.CHANNEL_BANNED||E===_.APPID_INVALID||E===_.SERVER_NOT_OPEN?a(new L(B.a.LoginError.LOGIN_ERR_INVALID_APP_ID)):E===_.TOKEN_EXPIRED?a(new L(B.a.LoginError.LOGIN_ERR_TOKEN_EXPIRED,\"You must request a new token from your server and call join to use the new token to join the channel\")):E===_.TOKEN_INVALID?a(new L(B.a.LoginError.LOGIN_ERR_INVALID_TOKEN,\"make sure token is right and try again please\")):E===_.UNKNOWN?a(new L(B.a.LoginError.LOGIN_ERR_UNKNOWN)):E===_.TIMEOUT&&a(new L(B.a.LoginError.LOGIN_ERR_TIMEOUT)),[2]):(r.token=t,l=u.addresses,R=u.sessionid,r._sessionId=R,!l||l instanceof Array&&0===l.length?(a(new L(B.a.LoginError.LOGIN_ERR_UNKNOWN,\"gateway connect failed: Can not find service list\")),[2]):[4,K(r._connectRtmServer(u,e,t))]);case 2:return N=X.apply(void 0,[U.sent(),1]),(d=N[0])?(a(d),[2]):(f={UserId:e,UserSId:r._sid,AcsToken:t||\"\",SdkVer:o.VERSION,SessionId:r._sessionId},[4,K(r._rtmServer.doOnline(f))]);case 3:return O=X.apply(void 0,[U.sent(),2]),T=O[0],h=O[1],T?(null===(b=r._rtmServer)||void 0===b||b.disconnectServer(),r._emitConnectionState(P.a.ConnectionState.DISCONNECTED,P.a.ConnectionChangeReason.LOGIN_FAILURE),a(T),[2]):(r.uid=h,r._emitConnectionState(P.a.ConnectionState.CONNECTED,P.a.ConnectionChangeReason.LOGIN_SUCCESS),i(r.uid),[4,K(n.getOfflineMsg({uid:r.uid}))]);case 4:return p=X.apply(void 0,[U.sent(),2]),v=p[0],A=p[1],v?(c.error(\"get offline message failed\"),[2]):(A&&(m=A.code,g=A.data,0===m&&g.map((function(e){var t=e.msgFrom,n=(e.msgStatus,e.msgType),o=e.msgBody,i={isHistoricalMessage:!1,isOfflineMessage:!0,serverReceivedTs:e.msgTs};if(1===n){var a={text:o};r.emit(\"MessageFromPeer\",a,t,i)}}))),[4,K(n.getP2PHistoryMsg({fromUId:r.uid}))]);case 5:return S=X.apply(void 0,[U.sent(),2]),C=S[0],y=S[1],C?(c.error(\"get history message failed\"),[2]):(y&&(m=y.code,g=y.data,0===m&&g.map((function(e){var t=e.msgFrom,n=(e.msgStatus,e.msgType),o=e.msgBody,i={isHistoricalMessage:!0,isOfflineMessage:!1,serverReceivedTs:e.msgTs};if(1===n){var a={text:o};r.emit(\"MessageFromPeer\",a,t,i)}}))),[2])}}))}))}))},t.prototype._connectRtmServer=function(e,t,n){var r=this,i=this,a=e.addresses,s=(e.sessionid,a.filter((function(e){return 0===e.type})));return new Promise((function(e,a){return Q(r,void 0,void 0,(function(){var r,a,E,_,u,l,R,N,d,f,I=this;return z(this,(function(O){switch(O.label){case 0:r=!1,O.label=1;case 1:O.trys.push([1,6,7,8]),a=$(s),E=a.next(),O.label=2;case 2:return E.done?[3,5]:(_=E.value,c.info(\"begin connect rtm server \",_),null===(N=i._rtmServer)||void 0===N||N.setAppInfo({appId:i._appId}),null===(d=i._rtmServer)||void 0===d||d.configServer(i._useWss,_.addr,_.port),[4,null===(f=i._rtmServer)||void 0===f?void 0:f.connectServer()]);case 3:return O.sent(),e(),r=!0,[3,5];case 4:return E=a.next(),[3,2];case 5:return[3,8];case 6:return u=O.sent(),l={error:u},[3,8];case 7:try{E&&!E.done&&(R=a.return)&&R.call(a)}finally{if(l)throw l.error}return[7];case 8:return r||(Date.now()-i._joinStartTime<o.GATEWAY_RETRY_TIMEOUT?setTimeout((function(){I._authGateWay(t,n)}),1e3):i._emitConnectionState(P.a.ConnectionState.DISCONNECTED,P.a.ConnectionChangeReason.LOGIN_FAILURE)),[2]}}))}))}))},t}(G);(f=d||(d={})).BUILD=\"\",f.ConnectionChangeReason=void 0,f.ConnectionState=void 0,f.END_CALL_PREFIX=\"\",f.LOG_FILTER_ERROR=\"LOG_FILTER_ERROR\",f.LOG_FILTER_INFO=\"LOG_FILTER_INFO\",f.LOG_FILTER_OFF=\"LOG_FILTER_OFF\",f.LOG_FILTER_WARNING=\"LOG_FILTER_WARNING\",f.LocalInvitationState=void 0,f.MessageType=void 0,f.PeerOnlineState=void 0,f.PeerSubscriptionOption=void 0,f.RemoteInvitationFailureReason=void 0,f.LocalInvitationFailureReason=void 0,f.RemoteInvitationState=void 0,f.VERSION=o.VERSION,f.createInstance=function(e,t){if(!/^[a-zA-Z0-9]{32}$/.test(e))throw new y(B.a.CreateInstanceError.CREATE_INSTANCE_ERR_INVALID_ARGUMENT,\"The appId in the arguments is invalid.\");var n=(t||{}).logFilter;if(n){var r=[\"\",\"LOG_FILTER_INFO\",\"LOG_FILTER_WARNING\",\"LOG_FILTER_ERROR\",\"LOG_FILTER_OFF\"],o=4;~r.indexOf(n)&&(o=r.findIndex((function(e){return e===n}))),c.setLogLevel(o,\"anyrtc-SDK\")}return new Z(e,t)}},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e){e.exports=JSON.parse('{\"name\":\"ar-rtm-sdk\",\"version\":\"1.0.5\",\"description\":\"JavaScript SDK for anyRTC RTM\",\"main\":\"release/ArRTM@latest.js\",\"typings\":\"release/ar-rtm-sdk.d.ts\",\"scripts\":{\"build\":\"webpack --mode=production\",\"dev\":\"webpack --mode=development\",\"doc\":\"rm -rf release/ar-rtm-sdk.d.ts && rm -rf lib && tsc && api-extractor run\"},\"files\":[\"release/*.js\",\"release/ar-rtm-sdk.d.ts\",\"README.md\"],\"author\":\"\",\"license\":\"MIT\",\"devDependencies\":{\"@types/js-base64\":\"^2.3.2\",\"@types/wechat-miniprogram\":\"^3.0.0\",\"awesome-typescript-loader\":\"^5.2.1\",\"typedoc\":\"^0.17.7\",\"typedoc-webpack-plugin\":\"^1.1.4\",\"typescript\":\"^3.9.3\",\"webpack\":\"^4.43.0\",\"webpack-cli\":\"^3.3.11\"},\"dependencies\":{}}')}]).default}));"]}